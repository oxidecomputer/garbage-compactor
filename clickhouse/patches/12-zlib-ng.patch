From 117e664a0a3c9c3db1568e5c6b338da9dcb2ad65 Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex@cooperi.net>
Date: Mon, 29 May 2023 09:58:59 +1000
Subject: [PATCH 11/42] 12-zlib-ng.patch

diff -wpruN --no-dereference '--exclude=*.orig' a~/contrib/zlib-ng/zutil_p.h a/contrib/zlib-ng/zutil_p.h
--- a~/contrib/zlib-ng/zutil_p.h	1970-01-01 00:00:00
+++ a/contrib/zlib-ng/zutil_p.h	1970-01-01 00:00:00
@@ -12,13 +12,14 @@
 #  include <malloc_np.h>
 #elif defined(__sun)
 #  include <stdlib.h>
+#  include <sys/mman.h>
 #else
 #  include <malloc.h>
 #endif
 
 /* Function to allocate 16 or 64-byte aligned memory */
 static inline void *zng_alloc(size_t size) {
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(OS_SUNOS)
     void *ptr;
     return posix_memalign(&ptr, 64, size) ? NULL : ptr;
 #elif defined(_WIN32)
